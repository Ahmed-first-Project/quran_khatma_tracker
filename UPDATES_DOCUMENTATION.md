# ุชูุซูู ุงูุชุญุฏูุซุงุช - 06 ูุจุฑุงูุฑ 2026

## ููุฎุต ุงูุชุญุฏูุซุงุช

ุชู ุฅุฌุฑุงุก ุซูุงุซุฉ ุชุญุฏูุซุงุช ุฑุฆูุณูุฉ ุนูู ูุธุงู ุชุชุจุน ุงูุฎุชูุฉ ุงููุฑุขููุฉ:

### 1. ุฅุตูุงุญ ุญุณุงุจ ุชุงุฑูุฎ ุงูุฌูุนุฉ โ

**ุงููุดููุฉ:**
- ูุงู ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ุฎุงุทุฆุงู: `2025-11-20` (ุงูุฃุฑุจุนุงุก) ุจุฏูุงู ูู `2025-11-21` (ุงูุฎููุณ)
- ูุฐุง ุชุณุจุจ ูู ูุฑู ููู ูุงุญุฏ ูู ุฌููุน ุงูุชูุงุฑูุฎ

**ุงูุญู:**
- ุชู ุชุญุฏูุซ ุฌููุน ุชูุงุฑูุฎ ุงูุฌูุนุงุช (181-210) ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชู ุงุณุชุฎุฏุงู `new Date(2025, 10, 21)` ุจุฏูุงู ูู `new Date('2025-11-21')` ูุชุฌูุจ ูุดุงูู UTC

**ุงููุชูุฌุฉ:**
- ุงูุฌูุนุฉ 181: 21-11-2025 (ุงูุฎููุณ) โ
- ุงูุฌูุนุฉ 192: 06-02-2026 (ุงูุฎููุณ) โ โ ุงูููู
- ุงูุฌูุนุฉ 210: 12-06-2026 (ุงูุฎููุณ) โ

**ุงููููุงุช ุงููุนุฏูุฉ:**
- `fix_friday_dates.mjs` (ุณูุฑูุจุช ุงูุชุญุฏูุซ)
- ุฌุฏูู `fridays` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

### 2. ุชูุนูู ุงูุชูุจููุงุช ุงูุชููุงุฆูุฉ โฐ

**ุงููุถุน ุงูุณุงุจู:**
- ูุธุงู ุงูุชูุจููุงุช ููุฌูุฏ ููู ุบูุฑ ููุนูู
- ุงูุฅุนุฏุงุฏุงุช ุงููุทููุจุฉ ุบูุฑ ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุชูุนูู:**
ุชู ุฅุถุงูุฉ ุงูุฅุนุฏุงุฏุงุช ุงูุชุงููุฉ ูู ุฌุฏูู `notificationSettings`:

```sql
INSERT INTO notificationSettings (settingKey, settingValue, description) 
VALUES 
  ('auto_reminders_enabled', 'true', 'ุชูุนูู ุงูุชูุจููุงุช ุงูุชููุงุฆูุฉ (ูู ุฎููุณ ุงูุณุงุนุฉ 6 ูุณุงุกู)'),
  ('current_friday_number', '192', 'ุฑูู ุงูุฌูุนุฉ ุงูุญุงููุฉ ููุชูุจููุงุช ุงูุชููุงุฆูุฉ');
```

**ููููุฉ ุงูุนูู:**
1. **ุงูุฌุฏููุฉ:** ูู ุฎููุณ ุงูุณุงุนุฉ 6 ูุณุงุกู (ุจุชูููุช GMT+3 - ุงูุฑูุงุถ)
2. **ุงููุณุชูุฏููู:** ุงููุดุชุฑููู ุงูุฐูู ูู ูุณุฌููุง ูุฑุงุกุงุชูู ููุฌูุนุฉ ุงูุญุงููุฉ
3. **ุงููุญุชูู:** ุฑุณุงูุฉ ุชุฐููุฑ ุชุญุชูู ุนูู:
   - ุงูุฌุฒุก ุงููุทููุจ
   - ุฑูู ุงููุฌููุนุฉ
   - ุชุงุฑูุฎ ุงูุฌูุนุฉ
   - ุฒุฑ "ุชู" ูุชุณุฌูู ุงููุฑุงุกุฉ
4. **ุงูุชูุฑูุฑ:** ูุชู ุฅุฑุณุงู ุชูุฑูุฑ ูููุดุฑููู ุจุนุฏ ุงูุฅุฑุณุงู ูุญุชูู ุนูู:
   - ุฅุฌูุงูู ุงููุชุฃุฎุฑูู
   - ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ุจูุฌุงุญ
   - ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุงุดูุฉ
   - ูุงุฆูุฉ ุจุงูุฃุฎุทุงุก

**ุงููููุงุช ุฐุงุช ุงูุตูุฉ:**
- `server/scheduler.ts` - ูุธุงู ุงูุฌุฏููุฉ
- `server/notificationService.ts` - ุฎุฏูุฉ ุงูุฅุดุนุงุฑุงุช
- `server/db.ts` - ุฏูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฌุฏูู `notificationSettings` - ุงูุฅุนุฏุงุฏุงุช
- ุฌุฏูู `notifications` - ุณุฌู ุงูุฅุดุนุงุฑุงุช

**Cron Expression:**
```
0 0 18 * * 4
โ โ โ  โ โ โ
โ โ โ  โ โ โโ ููู ุงูุฃุณุจูุน (4 = ุงูุฎููุณ)
โ โ โ  โ โโโโ ุงูุดูุฑ (ูู ุดูุฑ)
โ โ โ  โโโโโโ ุงูููู ูู ุงูุดูุฑ (ูู ููู)
โ โ โโโโโโโโโ ุงูุณุงุนุฉ (18 = 6 ูุณุงุกู)
โ โโโโโโโโโโโ ุงูุฏูููุฉ (0)
โโโโโโโโโโโโโ ุงูุซุงููุฉ (0)
```

---

### 3. ุฅุถุงูุฉ ุงูุชุฑุชูุจ ุงูุนุงู ูู ุตูุญุฉ "ุฅุญุตุงุฆูุงุชู" ๐

**ุงููุถุน ุงูุณุงุจู:**
ุตูุญุฉ "ุฅุญุตุงุฆูุงุชู" ูุงูุช ุชุนุฑุถ:
- ุนุฏุฏ ุงููุฑุงุกุงุช ุงูููุชููุฉ
- ุนุฏุฏ ุงููุฑุงุกุงุช ุงูููุชุธุฑุฉ
- ุงููุฑุงุกุงุช ุงููุชุชุงููุฉ (streak)
- ูุณุจุฉ ุงูุฅูุฌุงุฒ
- ุขุฎุฑ ูุฑุงุกุฉ
- ุชุฑุชูุจ ุงููุฌููุนุฉ (ูู 3)

**ุงูุชุญุฏูุซ:**
ุชู ุฅุถุงูุฉ **ุงูุชุฑุชูุจ ุงูุนุงู** ุจูู ุฌููุน ุงููุดุชุฑููู (170 ูุดุชุฑู).

**ุงูุฏุงูุฉ ุงูุฌุฏูุฏุฉ:**
```typescript
export async function getOverallRanking(personName: string): Promise<{
  rank: number;
  totalParticipants: number;
  completedReadings: number;
} | null>
```

**ุขููุฉ ุงูุญุณุงุจ:**
1. ุฌูุจ ุฌููุน ุงููุฑุงุกุงุช ูู ุฌุฏูู `readings`
2. ุญุณุงุจ ุนุฏุฏ ุงููุฑุงุกุงุช ุงูููุชููุฉ ููู ูุดุงุฑู
3. ุชุฑุชูุจ ุงููุดุงุฑููู ุชูุงุฒููุงู ุญุณุจ ุนุฏุฏ ุงููุฑุงุกุงุช
4. ุงูุจุญุซ ุนู ุชุฑุชูุจ ุงููุดุงุฑู ุงููุทููุจ

**ุงูุนุฑุถ:**
```
๐ ุชุฑุชูุจู ุงูุนุงู: 1 ูู 170    โ ุงููุฑูุฒ ุงูุฃูู
โญ ุชุฑุชูุจู ุงูุนุงู: 5 ูู 170    โ ุงููุฑุงูุฒ 2-10
๐ช ุชุฑุชูุจู ุงูุนุงู: 50 ูู 170   โ ุจุงูู ุงููุฑุงูุฒ
```

**ุงููููุงุช ุงููุนุฏูุฉ:**
- `server/db.ts` - ุฅุถุงูุฉ ุฏุงูุฉ `getOverallRanking`
- `server/telegramCallbackHandler.ts` - ุชุญุฏูุซ `handleMyStatus`

---

## ุงูุงุฎุชุจุงุฑุงุช

### ุงุฎุชุจุงุฑ ุงูุชูุงุฑูุฎ
```bash
node << 'EOF'
const startDate = new Date(2025, 10, 21);
console.log('ุชุงุฑูุฎ ุงูุจุฏุงูุฉ:', startDate.toISOString().split('T')[0]);
console.log('ุงูููู:', ['ุงูุฃุญุฏ', 'ุงูุงุซููู', 'ุงูุซูุงุซุงุก', 'ุงูุฃุฑุจุนุงุก', 'ุงูุฎููุณ', 'ุงูุฌูุนุฉ', 'ุงูุณุจุช'][startDate.getDay()]);

const weekOffset = 192 - 181;
const friday192 = new Date(startDate);
friday192.setDate(friday192.getDate() + (weekOffset * 7));

console.log('\nุงูุฌูุนุฉ 192:');
console.log('  ุงูุชุงุฑูุฎ:', friday192.toISOString().split('T')[0]);
console.log('  ุงูููู:', ['ุงูุฃุญุฏ', 'ุงูุงุซููู', 'ุงูุซูุงุซุงุก', 'ุงูุฃุฑุจุนุงุก', 'ุงูุฎููุณ', 'ุงูุฌูุนุฉ', 'ุงูุณุจุช'][friday192.getDay()]);
EOF
```

**ุงููุชูุฌุฉ:**
```
ุชุงุฑูุฎ ุงูุจุฏุงูุฉ: 2025-11-21
ุงูููู: ุงูุฎููุณ
ุงูุฌูุนุฉ 192:
  ุงูุชุงุฑูุฎ: 2026-02-06
  ุงูููู: ุงูุฎููุณ
```

### ุงุฎุชุจุงุฑ ุงูุชูุจููุงุช
```sql
SELECT * FROM notificationSettings;
```

**ุงููุชูุฌุฉ:**
```
settingKey                | settingValue | description
--------------------------|--------------|------------------------------------------
auto_reminders_enabled    | true         | ุชูุนูู ุงูุชูุจููุงุช ุงูุชููุงุฆูุฉ (ูู ุฎููุณ ุงูุณุงุนุฉ 6 ูุณุงุกู)
current_friday_number     | 192          | ุฑูู ุงูุฌูุนุฉ ุงูุญุงููุฉ ููุชูุจููุงุช ุงูุชููุงุฆูุฉ
```

### ุงุฎุชุจุงุฑ ุงูุชุฑุชูุจ ุงูุนุงู
```typescript
const overallRanking = await db.getOverallRanking('ุฃุญูุฏ ุงููุงุฐูุงูู');
console.log(overallRanking);
// { rank: 1, totalParticipants: 170, completedReadings: 0 }
```

---

## ุงูุฅุญุตุงุฆูุงุช

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุนุฏุฏ ุงููุดุชุฑููู:** 170
- **ุนุฏุฏ ุงููุฌููุนุงุช:** 57
- **ุนุฏุฏ ุงูุฌูุนุงุช:** 30 (ูู 181 ุฅูู 210)
- **ุฅุฌูุงูู ุงููุฑุงุกุงุช:** 1,710 (57 ูุฌููุนุฉ ร 30 ุฌูุนุฉ)
- **ุงููุฑุงุกุงุช ุงูููุชููุฉ:** 0 (ุฌููุนูุง ูุงุฑุบุฉ ุจุงูุชุธุงุฑ ุงูุชุณุฌูู)

### ุงูุชูุฒูุน
- **ุงูุฎุชูุฉ ุงูุฃููู:** 30 ุฌูุนุฉ (181-210)
- **ูู ูุฌููุนุฉ:** 3 ุฃุดุฎุงุต (ุจุนุถ ุงููุฌููุนุงุช ุดุฎุตูู ููุท)
- **ูู ุดุฎุต:** 30 ูุฑุงุกุฉ (ุฌุฒุก ูุงุญุฏ ูู ุฃุณุจูุน)

---

## ุงูุฎุทูุงุช ุงููุงุฏูุฉ ุงูููุชุฑุญุฉ

### 1. ุฅุถุงูุฉ ุฃูุฑ /ูุฌููุนุชู
ุนุฑุถ ุฃุนุถุงุก ุงููุฌููุนุฉ ูุน ุญุงูุฉ ูุฑุงุกุฉ ูู ุดุฎุต:
```
๐ฅ ูุฌููุนุชู (ุงููุฌููุนุฉ 4)

1. ุนุจุฏ ุงูุนุฒูุฒ ุงูุฎุฒุงุฑ
   ๐ ุงูุฌุฒุก 18
   โ ูู ูุณุฌู ุจุนุฏ

2. ุฃุญูุฏ ุงููุงุฐูุงูู (ุฃูุช)
   ๐ ุงูุฌุฒุก 19
   โ ุชู ุงูุชุณุฌูู

3. ุนุจุฏ ุงูุญููู ุนุจุฏุงูุบูู
   ๐ ุงูุฌุฒุก 20
   โ ูู ูุณุฌู ุจุนุฏ
```

### 2. ุชุญุณูู ุฑุณุงูุฉ ุงูุชุฐููุฑ
ุฅุถุงูุฉ ุฑุงุจุท ูุจุงุดุฑ ููุฌุฒุก ูู ุฑุณุงูุฉ ุงูุชุฐููุฑ ุงูุชููุงุฆูุฉ.

### 3. ุฅุถุงูุฉ ููุญุฉ ุงููุชุตุฏุฑูู
ุนุฑุถ ุฃูุถู 10 ูุดุชุฑููู ูู ุงูุจูุช:
```
๐ ููุญุฉ ุงููุชุตุฏุฑูู

1. ๐ฅ ูุญููุฏ ุฃุจู ุชูู - 30 ูุฑุงุกุฉ
2. ๐ฅ ุฃุญูุฏ ุงูุฌุณุฑู - 29 ูุฑุงุกุฉ
3. ๐ฅ ุญุณู ุงูุญูุฏ - 28 ูุฑุงุกุฉ
...
```

### 4. ุฅุญุตุงุฆูุงุช ุงููุฌููุนุฉ
ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงููุฌููุนุฉ ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ:
- ุฃูุซุฑ ุงููุฌููุนุงุช ุงูุชุฒุงูุงู
- ุงููุฌููุนุงุช ุงููุชุฃุฎุฑุฉ
- ูุนุฏู ุงูุฅูุฌุงุฒ ููู ูุฌููุนุฉ

---

## ุงูููุงุญุธุงุช ุงููููุฉ

### ูุดุงูู UTC
ุนูุฏ ุงูุชุนุงูู ูุน ุงูุชูุงุฑูุฎ ูู JavaScriptุ ูุฌุจ ุงุณุชุฎุฏุงู:
```javascript
// โ ุตุญูุญ
new Date(2025, 10, 21)  // Month is 0-indexed

// โ ุฎุงุทุฆ (ูุฏ ูุณุจุจ ูุดุงูู UTC)
new Date('2025-11-21')
```

### ุชุญุฏูุซ ุฑูู ุงูุฌูุนุฉ ุงูุญุงููุฉ
ูุฌุจ ุชุญุฏูุซ `current_friday_number` ูู ุฃุณุจูุน:
```sql
UPDATE notificationSettings 
SET settingValue = '193' 
WHERE settingKey = 'current_friday_number';
```

ุฃู ูููู ุฅุถุงูุฉ ุฏุงูุฉ ุชููุงุฆูุฉ ูุญุณุงุจ ุงูุฌูุนุฉ ุงูุญุงููุฉ ุจูุงุกู ุนูู ุงูุชุงุฑูุฎ.

### Rate Limiting
ุนูุฏ ุฅุฑุณุงู ุงูุชุฐููุฑุงุชุ ูุชู ุฅุถุงูุฉ ุชุฃุฎูุฑ 100ms ุจูู ูู ุฑุณุงูุฉ ูุชุฌูุจ rate limiting ูู Telegram:
```typescript
await new Promise(resolve => setTimeout(resolve, 100));
```

---

## ุงูุณุฌูุงุช

### ุณุฌูุงุช ุงูุณูุฑูุฑ
```
[2026-02-06T12:33:11.201Z] [Scheduler] Automatic reminder scheduler started (Every Thursday at 6 PM)
```

### ุณุฌูุงุช ุงูุชูุจููุงุช
ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงููุฑุณูุฉ ูุชู ุญูุธูุง ูู ุฌุฏูู `notifications` ูุน:
- ุชุงุฑูุฎ ูููุช ุงูุฅุฑุณุงู
- ุงุณู ุงููุณุชูู
- ูุต ุงูุฑุณุงูุฉ
- ููุน ุงูุฅุดุนุงุฑ (reminder/manual/scheduled)
- ุงูุญุงูุฉ (sent/failed/pending)
- ุฑุณุงูุฉ ุงูุฎุทุฃ (ุฅู ูุฌุฏุช)

---

## ุงูุฎูุงุตุฉ

ุชู ุฅูุฌุงุฒ ุฌููุน ุงูุชุญุฏูุซุงุช ุงููุทููุจุฉ ุจูุฌุงุญ:
- โ ุฅุตูุงุญ ุชุงุฑูุฎ ุงูุฌูุนุฉ
- โ ุชูุนูู ุงูุชูุจููุงุช ุงูุชููุงุฆูุฉ
- โ ุฅุถุงูุฉ ุงูุชุฑุชูุจ ุงูุนุงู

ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ููุนูู ุจุดูู ูุงูู! ๐
